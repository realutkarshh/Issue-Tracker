<div class="min-h-screen bg-slate-50">
  <div class="max-w-7xl mx-auto px-3 sm:px-4 lg:px-8 py-4 sm:py-8">
    
    <!-- Header Section -->
    <div class="mb-6 sm:mb-8">
      <div class="flex flex-col space-y-4 sm:space-y-0 sm:flex-row sm:justify-between sm:items-start">
        <div class="space-y-1 sm:space-y-2">
          <h1 class="text-xl sm:text-2xl font-semibold text-slate-900">Issues</h1>
          <p class="text-slate-600 text-sm">Track and manage your project issues</p>
        </div>
        
        <!-- Action Buttons - Responsive Layout -->
        <div class="flex flex-col space-y-2 sm:space-y-0 sm:flex-row sm:space-x-3">
          <button 
            mat-stroked-button
            (click)="testConnection()"
            class="!border-slate-200 !text-slate-700 hover:!bg-slate-50 !px-3 sm:!px-4 !py-2 !text-sm sm:!text-base">
            <mat-icon class="!text-base mr-1 sm:mr-2">wifi</mat-icon>
            <span class="hidden sm:inline">Test Connection</span>
            <span class="sm:hidden">Test</span>
          </button>
          <button 
            mat-stroked-button
            (click)="refreshIssues()"
            [disabled]="loading"
            class="!border-slate-200 !text-slate-700 hover:!bg-slate-50 !px-3 sm:!px-4 !py-2 !text-sm sm:!text-base">
            <mat-icon class="!text-base mr-1 sm:mr-2">refresh</mat-icon>
            <span class="hidden sm:inline">Refresh</span>
            <span class="sm:hidden">Refresh</span>
          </button>
          <button 
            mat-flat-button
            routerLink="/create"
            class="!bg-slate-900 hover:!bg-slate-800 !text-white !px-4 sm:!px-6 !py-2 !font-medium !text-sm sm:!text-base">
            <mat-icon class="!text-base mr-1 sm:mr-2">add</mat-icon>
            <span class="hidden sm:inline">New Issue</span>
            <span class="sm:hidden">New</span>
          </button>
        </div>
      </div>
    </div>

    <!-- Loading State -->
    <div *ngIf="loading" class="flex flex-col items-center justify-center py-12 sm:py-16">
      <mat-spinner diameter="32" class="!text-slate-400 mb-4"></mat-spinner>
      <p class="text-slate-500 text-sm">Loading issues...</p>
    </div>

    <!-- Error State -->
    <div *ngIf="error && !loading" class="bg-red-50 border-l-4 border-red-400 p-3 sm:p-4 mb-6 sm:mb-8">
      <div class="flex items-start">
        <mat-icon class="text-red-400 mr-2 sm:mr-3 mt-0.5 !text-lg sm:!text-xl">error_outline</mat-icon>
        <div class="flex-1">
          <h3 class="text-red-800 font-medium text-sm sm:text-base">Connection Failed</h3>
          <p class="text-red-700 text-xs sm:text-sm mt-1">{{ error }}</p>
          <button 
            mat-stroked-button 
            (click)="refreshIssues()"
            class="!border-red-200 !text-red-700 hover:!bg-red-50 !px-3 !py-1 !text-xs sm:!text-sm mt-2 sm:mt-3">
            Try Again
          </button>
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <div *ngIf="!loading && !error && issues.length === 0" class="text-center py-12 sm:py-16">
      <div class="w-12 h-12 sm:w-16 sm:h-16 mx-auto mb-3 sm:mb-4 bg-slate-100 rounded-full flex items-center justify-center">
        <mat-icon class="text-slate-400 !text-xl sm:!text-2xl">inbox</mat-icon>
      </div>
      <h3 class="text-slate-900 font-medium mb-2 text-base sm:text-lg">No issues yet</h3>
      <p class="text-slate-600 text-sm mb-4 sm:mb-6">Get started by creating your first issue</p>
      <button mat-flat-button routerLink="/create" class="!bg-slate-900 !text-white !px-4 sm:!px-6 !py-2">
        <mat-icon class="mr-2">add</mat-icon>
        Create Issue
      </button>
    </div>

    <!-- Issues Table - Responsive Container -->
    <div *ngIf="!loading && !error && issues.length > 0" class="bg-white rounded-lg border border-slate-200 overflow-hidden shadow-sm">
      
      <!-- Table Header Info -->
      <div class="px-3 sm:px-6 py-3 sm:py-4 border-b border-slate-200 bg-slate-50">
        <div class="flex items-center justify-between">
          <h2 class="text-slate-900 font-medium text-sm sm:text-base">All Issues</h2>
          <span class="text-slate-500 text-xs sm:text-sm">{{ issues.length }} total</span>
        </div>
      </div>

      <!-- Responsive Table Container -->
      <div class="overflow-x-auto">
        <div class="min-w-full inline-block align-middle">
          <table mat-table [dataSource]="dataSource" class="min-w-full divide-y divide-slate-200">

            <!-- ID Column -->
            <ng-container matColumnDef="id">
              <th mat-header-cell *matHeaderCellDef 
                  class="!px-2 sm:!px-6 !py-3 sm:!py-4 !text-left !font-medium !text-slate-700 !text-xs sm:!text-sm !bg-slate-50">
                <span class="hidden sm:inline">ID</span>
                <span class="sm:hidden">#</span>
              </th>
              <td mat-cell *matCellDef="let issue" class="!px-2 sm:!px-6 !py-3 sm:!py-4 !whitespace-nowrap">
                <span class="text-slate-500 text-xs sm:text-sm font-mono">#{{ issue.id }}</span>
              </td>
            </ng-container>
            
            <!-- Title Column -->
            <ng-container matColumnDef="title">
              <th mat-header-cell *matHeaderCellDef 
                  class="!px-2 sm:!px-6 !py-3 sm:!py-4 !text-left !font-medium !text-slate-700 !text-xs sm:!text-sm !bg-slate-50 !min-w-[200px] sm:!min-w-[250px]">
                Title
              </th>
              <td mat-cell *matCellDef="let issue" class="!px-2 sm:!px-6 !py-3 sm:!py-4 !max-w-[200px] sm:!max-w-[300px]">
                <div class="cursor-pointer group" (click)="viewIssue(issue)">
                  <h4 class="font-medium text-slate-900 group-hover:text-slate-700 transition-colors text-xs sm:text-sm leading-tight">
                    {{ issue.title }}
                  </h4>
                  <p class="text-slate-500 text-xs mt-1 line-clamp-2 hidden sm:block" *ngIf="issue.description">
                    {{ issue.description | slice:0:80 }}{{ issue.description.length > 80 ? '...' : '' }}
                  </p>
                </div>
              </td>
            </ng-container>

            <!-- Status Column -->
            <ng-container matColumnDef="status">
              <th mat-header-cell *matHeaderCellDef 
                  class="!px-2 sm:!px-6 !py-3 sm:!py-4 !text-left !font-medium !text-slate-700 !text-xs sm:!text-sm !bg-slate-50 !whitespace-nowrap">
                Status
              </th>
              <td mat-cell *matCellDef="let issue" class="!px-2 sm:!px-6 !py-3 sm:!py-4 !whitespace-nowrap">
                <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium"
                      [ngClass]="getStatusClasses(issue.status)">
                  <span class="hidden sm:inline">{{ issue.status | titlecase }}</span>
                  <span class="sm:hidden">{{ (issue.status | titlecase) | slice:0:3 }}</span>
                </span>
              </td>
            </ng-container>

            <!-- Priority Column -->
            <ng-container matColumnDef="priority">
              <th mat-header-cell *matHeaderCellDef 
                  class="!px-2 sm:!px-6 !py-3 sm:!py-4 !text-left !font-medium !text-slate-700 !text-xs sm:!text-sm !bg-slate-50 !whitespace-nowrap">
                Priority
              </th>
              <td mat-cell *matCellDef="let issue" class="!px-2 sm:!px-6 !py-3 sm:!py-4 !whitespace-nowrap">
                <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium"
                      [ngClass]="getPriorityClasses(issue.priority)">
                  <span class="hidden sm:inline">{{ issue.priority | titlecase }}</span>
                  <span class="sm:hidden">{{ (issue.priority | titlecase).charAt(0) }}</span>
                </span>
              </td>
            </ng-container>

            <!-- Assignee Column - Hidden on mobile -->
            <ng-container matColumnDef="assignee">
              <th mat-header-cell *matHeaderCellDef 
                  class="!px-2 sm:!px-6 !py-3 sm:!py-4 !text-left !font-medium !text-slate-700 !text-xs sm:!text-sm !bg-slate-50 !whitespace-nowrap hidden sm:!table-cell">
                Assignee
              </th>
              <td mat-cell *matCellDef="let issue" class="!px-2 sm:!px-6 !py-3 sm:!py-4 !whitespace-nowrap hidden sm:!table-cell">
                <span *ngIf="issue.assignee" class="text-slate-700 text-sm">{{ issue.assignee }}</span>
                <span *ngIf="!issue.assignee" class="text-slate-400 text-sm">Unassigned</span>
              </td>
            </ng-container>

            <!-- Updated At Column - Hidden on mobile -->
            <ng-container matColumnDef="updatedAt">
              <th mat-header-cell *matHeaderCellDef 
                  class="!px-2 sm:!px-6 !py-3 sm:!py-4 !text-left !font-medium !text-slate-700 !text-xs sm:!text-sm !bg-slate-50 !whitespace-nowrap hidden md:!table-cell">
                Updated
              </th>
              <td mat-cell *matCellDef="let issue" class="!px-2 sm:!px-6 !py-3 sm:!py-4 !whitespace-nowrap hidden md:!table-cell">
                <span *ngIf="issue.updated_at" class="text-slate-500 text-sm">{{ issue.updated_at | date:'MMM d' }}</span>
                <span *ngIf="!issue.updated_at" class="text-slate-400 text-sm">—</span>
              </td>
            </ng-container>

            <!-- Actions Column -->
            <ng-container matColumnDef="actions">
              <th mat-header-cell *matHeaderCellDef 
                  class="!px-2 sm:!px-6 !py-3 sm:!py-4 !text-center !font-medium !text-slate-700 !text-xs sm:!text-sm !bg-slate-50 !whitespace-nowrap">
                <span class="hidden sm:inline">Actions</span>
                <span class="sm:hidden">•••</span>
              </th>
              <td mat-cell *matCellDef="let issue" class="!px-2 sm:!px-6 !py-3 sm:!py-4 !text-center !whitespace-nowrap">
                <div class="flex justify-center items-center gap-0 sm:gap-1">
                  <button 
                    mat-icon-button 
                    (click)="editIssue(issue)" 
                    class="!text-slate-500 hover:!text-slate-700 !w-7 !h-7 sm:!w-8 sm:!h-8"
                    matTooltip="Edit issue">
                    <mat-icon class="!text-base sm:!text-lg">edit</mat-icon>
                  </button>
                  <button 
                    mat-icon-button 
                    (click)="deleteIssue(issue)" 
                    class="!text-slate-500 hover:!text-red-600 !w-7 !h-7 sm:!w-8 sm:!h-8"
                    matTooltip="Delete issue">
                    <mat-icon class="!text-base sm:!text-lg">delete</mat-icon>
                  </button>
                </div>
              </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns" 
                class="!bg-slate-50 !border-b !border-slate-200"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;" 
                class="hover:!bg-slate-50 !transition-colors !duration-150 !border-b !border-slate-100 last:!border-b-0"></tr>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
